select v.customer_id , count(t.visit_id is null) as count_no_trans 
from Visits v left join Transactions t on v.visit_id = t.visit_id 
where t.visit_id is null
group by v.customer_id 
order by count_no_trans desc;

another way----------------------------------------------------------------

select v.customer_id , count(t.visit_id is null) as count_no_trans  
from Visits v left join Transactions t on v.visit_id = t.visit_id where t.visit_id is null 
group by v.customer_id ;
